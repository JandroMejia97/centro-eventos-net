@using CentroEventos.UI.Auth;

@using CentroEventos.Aplicacion.Servicios

@inject IHttpContextAccessor HttpContextAccessor
@inject IServicioCacheDePermisos PermisosCache
@inject AuthenticationStateProvider AuthProvider
@inject NavigationManager NavigationManager
@code {

    protected override async Task OnInitializedAsync()
    {
        var customAuthenticationStateProvider = (CustomAuthStateProvider)AuthProvider;
        var intUserId = await customAuthenticationStateProvider.ExtractUserIdAsync();
        if (intUserId != 0)
        {
            PermisosCache.Eliminar(intUserId);
            await customAuthenticationStateProvider.MarkUserAsLoggedOutAsync();
        }
        NavigationManager.NavigateTo("/login");
    }
}
